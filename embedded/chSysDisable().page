---
title: ChibiOS/RT chSysDisable()
categories: embedded, arm, stm32, stm32f429
toc: yes
...

chSysDisable()
==============
| 在 GCC ports / ARMCMx 中，chSysDisable()是藉由設定 PRIMASK 這個中斷遮罩暫存器(Interrupt Mask Register)
| 來使所有的可遮罩式中斷資源失效，期間只允許處理不可遮罩式中斷(NMI)
| 
| In ChibiOS-RT-Community / os / kernel / include / chsys.h

.. code-block:: c

    #define chSysDisable() {                                                        \
      port_disable();                                                               \
      dbg_check_disable();                                                          \
    } 

port_disable(): In ChibiOS-RT-Community / os / ports / GCC / ARMCMx / chcore_v7m.h

.. code-block:: c

    /**
    * @brief   Disables all the interrupt sources.
    * @note    Of course non-maskable interrupt sources are not included.
    * @note    In this port it disables all the interrupt sources by raising
    *          the priority mask to level 0.
    */
    #define port_disable() asm volatile ("cpsid   i" : : : "memory")

    //cpsid i : Change Program State Interrupt Disable. Set PRIMASK, disable interrupts

